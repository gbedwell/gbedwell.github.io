<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>calibrateR - Undefined Functions</title>
<meta name="description" content="An R package to streamline standard laboratory calculations.">


  <meta name="author" content="Greg Bedwell">
  
  <meta property="article:author" content="Greg Bedwell">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Undefined Functions">
<meta property="og:title" content="calibrateR">
<meta property="og:url" content="http://localhost:4000/calibrateR/">


  <meta property="og:description" content="An R package to streamline standard laboratory calculations.">







  <meta property="article:published_time" content="2023-06-08T00:00:00-04:00">





  

  


<link rel="canonical" href="http://localhost:4000/calibrateR/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Greg Bedwell",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Undefined Functions Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Undefined Functions
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/year-archive/">Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/about.html">About Me</a>
            </li><li class="masthead__menu-item">
              <a href="/cv.html">CV</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/images/image001.png" alt="Greg Bedwell" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Greg Bedwell</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>computational biologist <code class="language-plaintext highlighter-rouge">|</code> protein chemist</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Boston, MA</span>
        </li>
      

      
        
          
        
          
        
          
        
          
        
          
        
          
        
      

      

      
        <li>
          <a href="mailto:gregoryjbedwell@gmail.com" rel="me" class="u-email">
            <meta itemprop="email" content="gregoryjbedwell@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
          </a>
        </li>
      

      

      

      

      
        <li>
          <a href="https://www.linkedin.com/in/gregory-bedwell" itemprop="sameAs" rel="nofollow noopener noreferrer me">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span>
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/gbedwell" itemprop="sameAs" rel="nofollow noopener noreferrer me">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="calibrateR">
    <meta itemprop="description" content="An R package to streamline standard laboratory calculations.">
    <meta itemprop="datePublished" content="2023-06-08T00:00:00-04:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/calibrateR/" class="u-url" itemprop="url">calibrateR
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <h3 id="introduction">Introduction</h3>

<p>When working at the bench, there are probably certain experiments and/or
calculations that you routinely do that you <i>hate</i> doing. There’s
no logical reason for why you feel this way. The experiment/calculation
isn’t hard <i>per se</i>, you just wish that you didn’t have to do it
<i>again</i>.</p>

<p>With this feeling of frustration in mind, I decided to streamline some
of these common calculations so that the heavy lifting is done behind
the scenes (insofar as there is anything truly “heavy” about these
calculations – perhaps “the clicking-and-dragging” is more apt). The
result, <code>calibrateR</code>, is an easy-to-use R package that
contains functions to help with Gibson assembly reaction setup, protein
concentration determination via colorimetric assays, size exclusion
column calibration, and more. I am happy to expand
<code>calibrateR</code>’s current functionalities. Please reach out with
other ideas/suggestions!</p>

<p><code>calibrateR</code> can be downloaded from
<a href="https://github.com/gbedwell/calibrateR">GitHub</a>.</p>

<h3 id="usage">Usage</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">calibrateR</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h4 id="colorimetric-assays">Colorimetric Assays</h4>

<p>I’ll start by describing the way that the package approaches
colorimetric assays. For those who might be unfamiliar, colorimetric
assays are a very common way of determining the concentration of
analytes in solution. There are various types of colorimetric assays,
but the general procedure is similar across the board. First, the user
must calibrate the assay by measuring the output signal across a range
of known analyte concentrations. Then, from the empirically determined
relationship between analyte concentration and signal, the concentration
of analyte in the experimentally relevant samples can be determined.</p>

<p>In the example below, I start with defined standard analyte
concentrations (<code>conc</code>) and three replicates
(<code>rep1-3</code>) of corresponding signal readings. Note that the
signal readings are entered <i>in the same order</i> as the known
concentrations.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">conc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0.75</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.25</span><span class="p">,</span><span class="w"> </span><span class="m">0.125</span><span class="p">,</span><span class="w"> </span><span class="m">0.025</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">
</span><span class="n">rep1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2.312</span><span class="p">,</span><span class="w"> </span><span class="m">1.786</span><span class="p">,</span><span class="w"> </span><span class="m">1.273</span><span class="p">,</span><span class="w"> </span><span class="m">1.035</span><span class="p">,</span><span class="w"> </span><span class="m">0.744</span><span class="p">,</span><span class="w"> </span><span class="m">0.484</span><span class="p">,</span><span class="w"> </span><span class="m">0.351</span><span class="p">,</span><span class="w"> </span><span class="m">0.237</span><span class="p">,</span><span class="w"> </span><span class="m">0.209</span><span class="p">)</span><span class="w">
</span><span class="n">rep2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2.249</span><span class="p">,</span><span class="w"> </span><span class="m">1.739</span><span class="p">,</span><span class="w"> </span><span class="m">1.207</span><span class="p">,</span><span class="w"> </span><span class="m">0.984</span><span class="p">,</span><span class="w"> </span><span class="m">0.701</span><span class="p">,</span><span class="w"> </span><span class="m">0.455</span><span class="p">,</span><span class="w"> </span><span class="m">0.338</span><span class="p">,</span><span class="w"> </span><span class="m">0.23</span><span class="p">,</span><span class="w"> </span><span class="m">0.209</span><span class="p">)</span><span class="w">
</span><span class="n">rep3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2.282</span><span class="p">,</span><span class="w"> </span><span class="m">1.715</span><span class="p">,</span><span class="w"> </span><span class="m">1.204</span><span class="p">,</span><span class="w"> </span><span class="m">0.99</span><span class="p">,</span><span class="w"> </span><span class="m">0.712</span><span class="p">,</span><span class="w"> </span><span class="m">0.484</span><span class="p">,</span><span class="w"> </span><span class="m">0.345</span><span class="p">,</span><span class="w"> </span><span class="m">0.24</span><span class="p">,</span><span class="w"> </span><span class="m">0.208</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Next, I will use the <code>calibrate_colorimetric()</code> function in
<code>calibrateR</code> to create a new function, here called
<code>bca()</code>, to do all of the downstream data analysis for me.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bca</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">calibrate_colorimetric</span><span class="p">(</span><span class="w"> </span><span class="n">conc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conc</span><span class="p">,</span><span class="w">
                               </span><span class="n">abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="n">rep1</span><span class="p">,</span><span class="w"> </span><span class="n">rep2</span><span class="p">,</span><span class="w"> </span><span class="n">rep3</span><span class="w"> </span><span class="p">),</span><span class="w">
                               </span><span class="n">with.blank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                               </span><span class="n">nrep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>With the calibrated function defined, we can do one of two things. The
first thing we should do is look at our fit and make sure it’s
reasonable. To do this, we’ll use our concentration values to calculate
expected signal values based on the fit parameters. To do this, call
<code>bca( a = conc, return.conc = FALSE )</code>. In this instance, we
enter the known concentration values, and tell the function that it is
<i>not</i> returning concentration values (it’s returning signal
values). Because the units of both concentration and signal can vary
widely across assays, I intentionally left units off of the example
plot.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="w"> </span><span class="n">ggplot2</span><span class="w"> </span><span class="p">)</span><span class="w">

</span><span class="n">bca.df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="w"> </span><span class="n">conc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conc</span><span class="p">,</span><span class="w">
                      </span><span class="n">meas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="n">rep1</span><span class="p">,</span><span class="w"> </span><span class="n">rep2</span><span class="p">,</span><span class="w"> </span><span class="n">rep3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">

</span><span class="n">bca.fit.df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="w"> </span><span class="n">conc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conc</span><span class="p">,</span><span class="w"> 
                          </span><span class="n">fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bca</span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conc</span><span class="p">,</span><span class="w"> </span><span class="n">return.conc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="w"> </span><span class="n">bca.df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conc</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">meas</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">21</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gray75"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bca.fit.df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conc</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fit</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme</span><span class="p">(</span><span class="w"> </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="p">),</span><span class="w">
         </span><span class="n">axis.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Concentration"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Signal"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../figures/2023-06-08/unnamed-chunk-5-1.png" width="80%" style="display: block; margin: auto;" />
The fit seems reasonable. The observed data points lie nicely along the
fitted line. Now that we’ve calibrated the assay and are fairly
confident that the calibration makes sense, we can feed in signal values
from samples of unknown concentration. Here, we’ll assume that we have
five unknown samples and that each unknown sample was measured at a
2-fold dilution. We will use <code>return.conc = TRUE</code> and
<code>df = 2</code> in <code>bca()</code> to tell the function that it
<i>is</i> returning concentration values and to define the dilution
factor(s), respectively. The returned units of concentration are the
same as the units of concentration used to make the standard curve.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="w"> </span><span class="m">1234</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">unk</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">runif</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">

</span><span class="n">bca</span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unk</span><span class="p">,</span><span class="w"> </span><span class="n">return.conc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="c1">#&gt; [1] 0.5453686 2.2248925 2.1818814 2.2284591 3.0128681</span><span class="w">
</span></code></pre></div></div>

<h4 id="gibson-assembly">Gibson assembly</h4>

<p>To calculate Gibson assembly reaction volumes, you need to define eight
parameters for each reaction. These are: insert concentration(s), insert
length(s), vector concentration, vector length, the number of fragments
in the reaction, the molar ratio of insert to vector, the mass of vector
in the reaction (in ng), and the final volume of the reaction
<i>before</i> the addition of 2x master mix. Concentration units should
be ng/µL (or equivalent) and length units should be bp.</p>

<p>The function can calculate parameters for multiple reactions one fell
swoop. Vectors with lengths corresponding to the number of unique
reactions must be entered for all parameters except insert concentration
and insert length. For each reaction, the function will then extract the
relevant parameters from the input vectors and perform the requisite
calculations. A list of data frames is returned, where each list element
represents a unique reaction.</p>

<p>In the example below, I’m calculating reaction parameters for two
reactions. The first reaction has 2 input fragments and the second has
3.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gibson</span><span class="p">(</span><span class="w"> </span><span class="n">insert.conc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">35</span><span class="p">,</span><span class="w"> </span><span class="m">78</span><span class="p">,</span><span class="w"> </span><span class="m">48</span><span class="p">,</span><span class="w"> </span><span class="m">37</span><span class="p">,</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="p">),</span><span class="w"> 
        </span><span class="n">insert.len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">1894</span><span class="p">,</span><span class="w"> </span><span class="m">2403</span><span class="p">,</span><span class="w"> </span><span class="m">887</span><span class="p">,</span><span class="w"> </span><span class="m">1764</span><span class="p">,</span><span class="w"> </span><span class="m">943</span><span class="w"> </span><span class="p">),</span><span class="w">
        </span><span class="n">vec.conc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">55</span><span class="p">,</span><span class="w"> </span><span class="m">65</span><span class="w"> </span><span class="p">),</span><span class="w"> 
        </span><span class="n">vec.len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">4710</span><span class="p">,</span><span class="w"> </span><span class="m">5934</span><span class="w"> </span><span class="p">),</span><span class="w"> 
        </span><span class="n">n.frag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="p">),</span><span class="w"> 
        </span><span class="n">vec.mass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">),</span><span class="w">
        </span><span class="n">molar.ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">),</span><span class="w"> 
        </span><span class="n">final.vol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">),</span><span class="w"> 
        </span><span class="n">ids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="s2">"Reaction 1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Reaction 2"</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="c1">#&gt; $`Reaction 1`</span><span class="w">
</span><span class="c1">#&gt;            Volume</span><span class="w">
</span><span class="c1">#&gt; Fragment 1   1.72</span><span class="w">
</span><span class="c1">#&gt; Fragment 2   0.98</span><span class="w">
</span><span class="c1">#&gt; Vector       0.91</span><span class="w">
</span><span class="c1">#&gt; Water        1.39</span><span class="w">
</span><span class="c1">#&gt; Master Mix   5.00</span><span class="w">
</span><span class="c1">#&gt; </span><span class="w">
</span><span class="c1">#&gt; $`Reaction 2`</span><span class="w">
</span><span class="c1">#&gt;            Volume</span><span class="w">
</span><span class="c1">#&gt; Fragment 1   0.47</span><span class="w">
</span><span class="c1">#&gt; Fragment 2   1.21</span><span class="w">
</span><span class="c1">#&gt; Fragment 3   0.60</span><span class="w">
</span><span class="c1">#&gt; Vector       0.77</span><span class="w">
</span><span class="c1">#&gt; Water        1.95</span><span class="w">
</span><span class="c1">#&gt; Master Mix   5.00</span><span class="w">
</span></code></pre></div></div>

<h4 id="size-exclusion-column-calibration">Size exclusion column calibration</h4>

<p>Size exclusion chromatography (SEC) is a wildly available technique that
can provide useful information about macromolecules. Most commonly, SEC
is associated with molecular weight. However, SEC actually separates
macromolecules according to their hydrodynamic radius (or Stokes
radius). For macromolecules with similar overall shapes, changes in
hydrodynamic radius are due predominantly to changes in the number of
atoms present in the molecule (i.e., its mass). For macromolecules of
different shapes, however, separation based on hydrodynamic radius is a
poor indicator of molecular weight. For this reason, it is important to
be able to calibrate SEC columns for both radius and mass.</p>

<p>The <code>calibrate_sec()</code> function in <code>calibrateR</code>
works similarly to the <code>calibrate_colorimetric()</code> function
described above. The function minimally requires the user to define
three parameters: the measured elution volume of standard analytes, the
masses (yes, just the masses; in Da) of standard analytes, and the
macromolecular parameter of interest – either molecular weight
(<code>mw</code>) or hydrodynamic radius (<code>rh</code>).</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">masses</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">670000</span><span class="p">,</span><span class="w"> </span><span class="m">158000</span><span class="p">,</span><span class="w"> </span><span class="m">44000</span><span class="p">,</span><span class="w"> </span><span class="m">17000</span><span class="p">,</span><span class="w"> </span><span class="m">1350</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">rep1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">13.36</span><span class="p">,</span><span class="w"> </span><span class="m">16.07</span><span class="p">,</span><span class="w"> </span><span class="m">17.56</span><span class="p">,</span><span class="w"> </span><span class="m">18.46</span><span class="p">,</span><span class="w"> </span><span class="m">20.30</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">rep2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">13.32</span><span class="p">,</span><span class="w"> </span><span class="m">16.03</span><span class="p">,</span><span class="w"> </span><span class="m">17.49</span><span class="p">,</span><span class="w"> </span><span class="m">18.38</span><span class="p">,</span><span class="w"> </span><span class="m">20.23</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">rep3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">13.38</span><span class="p">,</span><span class="w"> </span><span class="m">16.09</span><span class="p">,</span><span class="w"> </span><span class="m">17.58</span><span class="p">,</span><span class="w"> </span><span class="m">18.48</span><span class="p">,</span><span class="w"> </span><span class="m">20.33</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sec.rh</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">calibrate_sec</span><span class="p">(</span><span class="w"> </span><span class="n">vols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="n">rep1</span><span class="p">,</span><span class="w"> </span><span class="n">rep2</span><span class="p">,</span><span class="w"> </span><span class="n">rep3</span><span class="w"> </span><span class="p">),</span><span class="w">
                         </span><span class="n">masses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">masses</span><span class="p">,</span><span class="w">
                         </span><span class="n">parameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rh"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Running <code>calibrate_sec()</code> returns a function for downstream
number crunching. Setting <code>parameter = “rh”</code> uses a
<a href="https://febs.onlinelibrary.wiley.com/doi/full/10.1046/j.0014-2956.2001.02649.x?sid=nlm%3Apubmed">previously
published</a>
scaling law to convert the provided mass values to radius values.</p>

<p>Convention for SEC column calibration plots is to plot $\log{(M)}$ or
$\log{(R_H)}$ vs. volume. Here, I will create a sequence of dummy
elution volumes between the observed elution volumes for the standard
analytes. Because I calibrated the column based on hydrodynamic radius
instead of mass, I will use the function <code>mass_to_radius()</code>
to convert the standard analyte masses to hydrodynamic radii. Then, I
will use the calibration to calculate the expected radii of analytes
eluting at each of the dummy elution volumes. Non-normalized elution
volumes are typically entered in mL units. Because these units don’t
strictly matter, however, I’ve left those units off of the plot. The
y-axis values are log-transformed. By default, however, the function
automatically re-transforms the expected values to the linear scale.
Note that the input mass units must be g/mol (Daltons). Calculated mass
values are returned in the same units. Hydrodynamic radius values are
returned in nm.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sec.df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="w"> </span><span class="n">vols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="n">rep1</span><span class="p">,</span><span class="w"> </span><span class="n">rep2</span><span class="p">,</span><span class="w"> </span><span class="n">rep3</span><span class="w"> </span><span class="p">),</span><span class="w">
                      </span><span class="n">rads</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mass_to_radius</span><span class="p">(</span><span class="w"> </span><span class="n">masses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">masses</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">

</span><span class="n">sec.fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="w"> </span><span class="n">vols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="w"> </span><span class="m">13</span><span class="p">,</span><span class="w"> </span><span class="m">21</span><span class="p">,</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="p">),</span><span class="w">
                       </span><span class="n">fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sec.rh</span><span class="p">(</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="w"> </span><span class="m">13</span><span class="p">,</span><span class="w"> </span><span class="m">21</span><span class="p">,</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="w"> </span><span class="n">sec.df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vols</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="w"> </span><span class="n">rads</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">21</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gray75"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sec.fit</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vols</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="w"> </span><span class="n">fit</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme</span><span class="p">(</span><span class="w"> </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="p">),</span><span class="w">
         </span><span class="n">axis.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Elution Volume"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"log(Rh)"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../figures/2023-06-08/unnamed-chunk-10-1.png" width="80%" style="display: block; margin: auto;" /></p>

<p>To apply the calibrated function to analytes of unknown mass/radius,
simply enter the empirical elution volume of the analyte into the
function. If the column calibration was done using normalized elution
volumes, the function <code>normalize_ev()</code> will normalize the
analyte elution volumes based on the column’s void and column volumes.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sec.rh</span><span class="p">(</span><span class="w"> </span><span class="m">16.495</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="c1">#&gt;      a </span><span class="w">
</span><span class="c1">#&gt; 3.9831</span><span class="w">
</span></code></pre></div></div>

<h4 id="uvvis">UV/vis</h4>

<p>Concentration determination by UV/Vis spectroscopy is very common in the
lab. The <code>calibrateR</code> function <code>uv_vis()</code> takes as
input the measured absorbance at the desired wavelength, the extinction
coefficient of the molecule of interest, the dilution factor of the
measurement, the path length of light, and the type of molecule being
measured. If the type of molecule being measured is “protein”, the
extinction coefficient must be defined. If the type of molecule is one
of “dsDNA”, “ssDNA”, or “ssRNA”, the extinction coefficient can be
<code>NULL</code>, and the standard (average) extinction coefficients
for these macromolecules are used. The path length defaults to 1 cm.</p>

<p>In the example below, a two-fold dilution of a purified protein with an
extinction coefficient of 35000 M<sup>-1</sup>cm<sup>-1</sup> was
measured to have an absorbance of 0.491 at 280 nm. <code>uv_vis()</code>
returns concentrations in same concentration units used in the
extinction coefficient. In the example, that is molar units.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">uv_vis</span><span class="p">(</span><span class="w"> </span><span class="n">abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.491</span><span class="p">,</span><span class="w"> 
        </span><span class="n">ext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">35000</span><span class="p">,</span><span class="w">
        </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">
        </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"protein"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="c1">#&gt; [1] 2.805714e-05</span><span class="w">
</span></code></pre></div></div>

        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2023-06-08T00:00:00-04:00">June 8, 2023</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=calibrateR%20http%3A%2F%2Flocalhost%3A4000%2FcalibrateR%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2FcalibrateR%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2FcalibrateR%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/nb-convolutions/" class="pagination--pager" title="nbconv
">Previous</a>
    
    
      <a href="/ecf-three/" class="pagination--pager" title="The ECF, the 3 point shot, and empirical Bayes
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">You may also enjoy</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ecf-three/" rel="permalink">The ECF, the 3 point shot, and empirical Bayes
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          7 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Analyzing 3 point shooting percentage in the 2023 NBA playoffs.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/nb-convolutions/" rel="permalink">nbconv
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">An R package to evaluation negative binomial convolutions.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/random-genome-fragments/" rel="permalink">Generating random genome fragments in R
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Quickly and easily generating simulated random fragments of a chosen genome.
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Greg Bedwell. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>









<script type="text/javascript" async
	src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
   MathJax.Hub.Config({
     extensions: ["tex2jax.js"],
     jax: ["input/TeX", "output/HTML-CSS"],
     tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"] ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
       processEscapes: true
     },
     "HTML-CSS": { availableFonts: ["TeX"] }
   });
</script>


  </body>
</html>
